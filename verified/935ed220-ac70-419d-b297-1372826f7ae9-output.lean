/-
This file was generated by Aristotle.

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 935ed220-ac70-419d-b297-1372826f7ae9
-/

/-
We formalize Weierstrass' trigonometric approximation theorem for continuous periodic functions on ℝ with period 2π. The theorem states that such functions can be uniformly approximated by trigonometric polynomials. We use `AddCircle (2 * π)` to represent ℝ/(2πℤ), the circle of circumference 2π. `TrigonometricPolynomial f` means f is in the subalgebra generated by the Fourier basis. The proof relies on the Stone-Weierstrass theorem, specifically the result `fourierSubalgebra_closure_eq_top` which states that the subalgebra generated by Fourier modes is dense in the space of continuous functions.
-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

open Real
open Complex
open Set
open Filter
open scoped Real
open scoped BigOperators

#check AddCircle
#check AddCircle.toCircle
#check fourierCoeff

#check fourier
#check Algebra.adjoin
#check Subalgebra.toSubmodule

#check Real.two_pi_pos

#check fourierSubalgebra
#check fourierSubalgebra_closure_eq_top

/-
Every continuous function that is periodic with period 2π can be uniformly approximated by trigonometric polynomials to any assigned degree of accuracy.
-/
instance : Fact (0 < 2 * π) := ⟨Real.two_pi_pos⟩

def TrigonometricPolynomial (f : C(AddCircle (2 * π), ℂ)) : Prop :=
  f ∈ fourierSubalgebra (T := 2 * π)

theorem weierstrass_trig_approx (f : C(AddCircle (2 * π), ℂ)) (ε : ℝ) (hε : ε > 0) :
    ∃ (P : C(AddCircle (2 * π), ℂ)), TrigonometricPolynomial P ∧ ∀ (x : AddCircle (2 * π)), ‖f x - P x‖ ≤ ε := by
  have := @fourierSubalgebra_closure_eq_top;
  -- Let's choose any trigonometric polynomial $P$ that approximates $f$ within $\epsilon$.
  obtain ⟨P, hP⟩ : ∃ P : C(AddCircle (2 * ↑Real.pi), ℂ), P ∈ fourierSubalgebra ∧ ‖f - P‖ < ε := by
    have h_dense : ∀ {f : C(AddCircle (2 * Real.pi), ℂ)}, ∀ ε > 0, ∃ P ∈ fourierSubalgebra, ‖f - P‖ < ε := by
      intro f ε hε;
      replace this := SetLike.ext_iff.mp this f;
      simpa [ dist_eq_norm ] using Metric.mem_closure_iff.mp ( this.mpr trivial ) ε hε;
    exact h_dense ε hε;
  refine' ⟨ P, _, _ ⟩;
  · bound;
  · exact fun x => le_trans ( ContinuousMap.norm_coe_le_norm ( f - P ) x ) hP.2.le